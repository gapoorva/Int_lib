function randstr(a){for(var b="",c=0;c<a;c++)b+="1350789624"[Math.floor(10*Math.random())];for(a=0;"0"==b[a];)++a;for(b=b.substring(a);0<a--;)b+="756921843"[Math.floor(9*Math.random())];return b}
function runCorrectnessTest(a){var b=[],c=[];switch(a){case "+":a=Int_add;break;case "-":a=Int_sub;break;case "*":a=Int_mul;break;case "/":a=Int_div;break;case "%":a=Int_mod;break;default:a=Int_eq}for(var e=0;100>e;++e){for(var d=[],f=[],h=0;50>h;h++)d.push(randstr(e+1)),f.push(randstr(e+1));b.push(d);c.push(f)}document.createElement("DIV");e=new Date;for(d=0;100>d;++d)for(console.log(d),f=0;50>f;++f){var g=new Int(b[d][f]),h=new Int(c[d][f]),k=a(g,h);document.getElementById("body").appendChild(document.createTextNode(g.get()+
" "+h.get()+" "+k.get()));document.getElementById("body").appendChild(document.createElement("br"));var k=new Int(c[99-d][f]),m=a(g,k);document.getElementById("body").appendChild(document.createTextNode(g.get()+" "+k.get()+" "+m.get()));document.getElementById("body").appendChild(document.createElement("br"));g=new Int(b[99-d][f]);k=a(g,h);document.getElementById("body").appendChild(document.createTextNode(g.get()+" "+h.get()+" "+k.get()));document.getElementById("body").appendChild(document.createElement("br"))}for(b=
100;2<=b;--b)for(c=b-1;1<=c;--c)console.log(b,c),d=new Int(b),f=new Int(c),h=a(d,f),document.getElementById("body").appendChild(document.createTextNode(d.get()+" "+f.get()+" "+h.get())),document.getElementById("body").appendChild(document.createElement("br"));console.log("25000 binary ops executed in: ",(new Date-e)/1E3,"seconds")};function divCrossoverTest(){for(var a=[],b=[],c=[],e=[],d=0;250>d;++d){for(var f=[],h=[],g=0;3>g;g++)f.push(randstr(d+1)),h.push(randstr(d+1));a.push(f);b.push(h);c.push({sum:0,cnt:0,avg:0});e.push({sum:0,cnt:0,avg:0})}console.log("running long division tests...");for(d=0;250>d;++d)for(console.log(d),f=d;250>f;++f)for(h=0;3>h;++h)g=new Date,Int_div_long(a[f][h],b[d][h]),c[f-d].sum+=new Date-g,c[f-d].cnt+=1;console.log("running fast division tests...");for(d=0;250>d;++d)for(console.log(d),f=d;250>
f;++f)for(h=0;3>h;++h)g=new Date,Int_div_fast(a[f][h],b[d][h]),e[f-d].sum+=new Date-g,e[f-d].cnt+=1;for(g=0;250>g;++g)c[g].avg=c[g].sum/c[g].cnt,e[g].avg=e[g].sum/e[g].cnt;console.log("DIG-DIFF | LONG | FAST");for(a=0;250>a;++a)console.log(a,"|",c[a].avg,"|",e[a].avg)};function performanceTest(a){var b={},c=a||20,e=0;for(a="add10 add50 add100 add1000 add10000 sub10 sub50 sub100 sub1000 sub10000 mul10 mul50 mul100 mul1000 div10 div50 div100 div1000 eq10 eq50 eq100 eq1000 eq10000 lt10 lt50 lt100 lt1000 lt10000".split(" ");c--;){for(var d=performanceUnit(),f=0;f<a.length;++f)b[a[f]]||(b[a[f]]=0),b[a[f]]+=d[a[f]];e++;console.log(c,"tests left")}for(c=0;c<a.length;++c)console.log(a[c],Math.round(b[a[c]]/e))}
function performanceUnit(){for(var a=[],b=[],c=[],e=[],d=[],f=[],h=[],g=[],k=[],m=[],l={},n=0;10>n;++n)a.push(Math.floor(10*Math.random())),b.push(Math.floor(10*Math.random())),c.push(Math.floor(10*Math.random())),e.push(Math.floor(10*Math.random())),d.push(Math.floor(10*Math.random())),f.push(Math.floor(10*Math.random())),h.push(Math.floor(10*Math.random())),g.push(Math.floor(10*Math.random())),k.push(Math.floor(10*Math.random())),m.push(Math.floor(10*Math.random()));for(n=0;40>n;++n)c.push(Math.floor(10*
Math.random())),e.push(Math.floor(10*Math.random())),d.push(Math.floor(10*Math.random())),f.push(Math.floor(10*Math.random())),h.push(Math.floor(10*Math.random())),g.push(Math.floor(10*Math.random())),k.push(Math.floor(10*Math.random())),m.push(Math.floor(10*Math.random()));for(n=0;50>n;++n)d.push(Math.floor(10*Math.random())),f.push(Math.floor(10*Math.random())),h.push(Math.floor(10*Math.random())),g.push(Math.floor(10*Math.random())),k.push(Math.floor(10*Math.random())),m.push(Math.floor(10*Math.random()));
for(n=0;900>n;++n)h.push(Math.floor(10*Math.random())),g.push(Math.floor(10*Math.random())),k.push(Math.floor(10*Math.random())),m.push(Math.floor(10*Math.random()));for(n=0;9E3>n;++n)k.push(Math.floor(10*Math.random())),m.push(Math.floor(10*Math.random()));var a=a.join(""),b=b.join(""),c=c.join(""),e=e.join(""),d=d.join(""),f=f.join(""),h=h.join(""),g=g.join(""),k=k.join(""),n=m.join(""),m=new Date,p=new Date;Int_add(a,b);l.add10=new Date-p;p=new Date;Int_add(c,e);l.add50=new Date-p;p=new Date;Int_add(d,
f);l.add100=new Date-p;p=new Date;Int_add(h,g);l.add1000=new Date-p;p=new Date;Int_add(k,n);l.add10000=new Date-p;p=new Date;Int_sub(a,b);l.sub10=new Date-p;p=new Date;Int_sub(c,e);l.sub50=new Date-p;p=new Date;Int_sub(d,f);l.sub100=new Date-p;p=new Date;Int_sub(h,g);l.sub1000=new Date-p;g=new Date;Int_sub(k,n);l.sub10000=new Date-g;g=new Date;Int_mul(a,b);l.mul10=new Date-g;g=new Date;Int_mul(c,e);l.mul50=new Date-g;e=new Date;Int_mul(d,f);l.mul100=new Date-e;e=new Date;Int_mul(h,f);l.mul1000=new Date-
e;e=new Date;Int_div(a,b);l.div10=new Date-e;e=new Date;Int_div(c,b);l.div50=new Date-e;e=new Date;Int_div(d,b);l.div100=new Date-e;e=new Date;Int_div(h,b);l.div1000=new Date-e;b=new Date;Int_eq(a,a);l.eq10=new Date-b;b=new Date;Int_eq(c,c);l.eq50=new Date-b;b=new Date;Int_eq(d,d);l.eq100=new Date-b;b=new Date;Int_eq(h,h);l.eq1000=new Date-b;b=new Date;Int_eq(k,k);l.eq10000=new Date-b;b=new Date;Int_lt(a,a);l.lt10=new Date-b;a=new Date;Int_lt(c,c);l.lt50=new Date-a;a=new Date;Int_lt(d,d);l.lt100=
new Date-a;a=new Date;Int_lt(h,h);l.lt1000=new Date-a;a=new Date;Int_lt(k,k);l.lt10000=new Date-a;l.overall=new Date-m;return l};function Int_add(a,b){a=Int_convertToInt(a);b=Int_convertToInt(b);if(a.is0())return b;if(b.is0())return a;if(a.is_negative&&!b.is_negative)return Int_sub(b,a);if(!a.is_negative&&b.is_negative)return Int_sub(a,b);var c=a.is_negative,e=new Int("z");e.data=[];for(var d=0,f=a.data.length>b.data.length?b.data.length:a.data.length,h=0;h<f;++h)d=a.data[h]+b.data[h]+d,e.data.push(d%Int.MAX_UNIT),d=d>=Int.MAX_UNIT?1:0;for(;f<a.data.length;)for(d=a.data[f++]+d,e.data.push(d%Int.MAX_UNIT),d=d>=Int.MAX_UNIT?
1:0;0==d&&f<a.data.length;)e.data.push(a.data[f++]);for(;f<b.data.length;)for(d=b.data[f++]+d,e.data.push(d%Int.MAX_UNIT),d=d>=Int.MAX_UNIT?1:0;0==d&&f<a.data.length;)e.data.push(a.data[f++]);0<d&&e.data.push(d);e.is_negative=c;return e}function Int_sum(a){for(var b=new Int("z"),c=0;c<a.length;++c)b=Int_add(b,a[c]);return b};function Int_mod(a,b){a=Int_convertToInt(a);b=Int_convertToInt(b);var c=Int_div(a,b,!0);a.is_negative&&(c=Int_sub(b,c));return c}function Int_pow(a,b){a=Int_convertToInt(a);b=Number(b);if(0>b)return new Int("z");if(0==b)return new Int(1);var c=1,e=[];for(e.push(new Int(a));2*c<=b;)c*=2,e.push(Int_mul(e[e.length-1],e[e.length-1]));for(var c=b-c,d=e[e.length-1];0<c;){for(var f=0,h=1;2*h<=c;)h+=h,f++;d=Int_mul(d,e[f]);c-=h}return d};function Int_eq(a,b){a=Int_convertToInt(a);b=Int_convertToInt(b);if(a.is0()&&b.is0())return!0;if(a.data.length!=b.data.length||a.is_negative!=b.is_negative)return!1;for(var c=0;c<a.data.length;++c)if(a.data[c]!=b.data[c])return!1;return!0}function Int_neq(a,b){return!Int_eq(a,b)}
function Int_lt(a,b){a=Int_convertToInt(a);b=Int_convertToInt(b);if(a.is0()&&b.is0())return!1;if(a.is_negative&&!b.is_negative)return!0;if(!a.is_negative&&b.is_negative)return!1;if(a.data.length<b.data.length)return!0;if(a.data.length>b.data.length)return!1;for(var c=a.data.length-1;0<=c;--c)if(a.data[c]!=b.data[c])return a.data[c]<b.data[c]?a.is_negative?!1:!0:a.is_negative?!0:!1;return!1}function Int_lteq(a,b){return Int_lt(a,b)||Int_eq(a,b)}
function Int_gt(a,b){return!Int_lt(a,b)&&Int_neq(a,b)}function Int_gteq(a,b){return!Int_lt(a,b)};function Int(a){this.MAX_DIGITS=14;this.data=[];this.updated=this.is_negative=!1;if(a instanceof Int){for(var b=0;b<a.data.length;++b)this.data.push(a.data[b]);this.is_negative=a.is_negative?!0:!1}else{if("number"==typeof a)a=Math.floor(a).toString();else if("string"!=typeof a)return console.error("ERROR: attempted construction of non-numeric object"),this.data.push(0),this.is_negative=!1,this;if("Z"==a||"z"==a)return this.data.push(0),this.updated=!0,this;if(!Int_isNumericString(a))return console.error("ERROR: cannot construct Int using '"+
a+"' which is a non-numeric string"),this.data.push(0),this.is_negative=!1,this;if("-"==a[0]){if(1==a.length)return this.is_negative=!0,this.data.push(0),this;this.is_negative=!0;a=a.substr(1)}if("+"==a[0]){if(1==a.length)return this.is_negative=!1,this.data.push(0),this;this.is_negative=!1;a=a.substr(1)}for(var b=!0,c=0;c<a.length;++c)if("0"!=a[c]){b=!1;break}if(b)return this.data.push(0),this.is_negative=!1,this;for(var c=a.length-1,e=0,d=0,b=0;b<Math.ceil(a.length/this.MAX_DIGITS);++b){for(d=0;0<=
c&&c>=a.length-this.MAX_DIGITS*(b+1);)e+="0123456789".indexOf(a[c--])*Math.pow(10,d++);this.data.push(e);e=0}this.updateRepresentation()}}Int.MAX_UNIT=1E14;Int.prototype.get=function(){var a=[];this.removeZeros();1==this.is_negative&&a.push("-");for(var b=this.data.length-1;0<=b;--b){for(var c=this.data[b].toString();1<this.data.length&&b!=this.data.length-1&&c.length<this.MAX_DIGITS;)c="0"+c;a.push(c)}return a.join("")};Int.prototype.toString=function(){return this.get()};
Int.prototype.repLength=function(){return this.data.length*this.MAX_DIGITS-(this.MAX_DIGITS-this.data[this.data.length-1].toString().length)};Int.prototype.negate=function(){this.is_negative=!this.is_negative;return this};Int.prototype.updateRepresentation=function(){if(!this.updated)return this.is0()&&(this.is_negative=!1),this.removeZeros(),this.updated=!0,this};
Int.prototype.removeZeros=function(){if(1==this.data.lenth)return this;for(;1<this.data.length&&0==this.data[this.data.length-1];)this.data.pop();return this};Int.prototype.is0=function(){for(var a in this.data)if(0!=this.data[a])return!1;return!0};
Int.prototype.ninesComplement=function(){var a=new Int("z");a.data=[];for(var b=0;b<this.data.length-1;++b)a.data.push(Int.MAX_UNIT-1);for(a.data.push(9);a.data[a.data.length-1]<this.data[this.data.length-1];)a.data[a.data.length-1]=10*a.data[a.data.length-1]+9;for(b=0;b<this.data.length;b++)a.data[b]-=this.data[b];return Int_add(a,1)};
function Int_isNumericString(a){if("string"!=typeof a||0==a.length||-1=="0123456789-+".indexOf(a[0]))return!1;for(var b=1;b<a.length;b++)if(-1=="0123456789".indexOf(a[b]))return!1;return!0}function Int_convertToInt(a){if(!(a instanceof Int)){if("string"==typeof a&&Int_isNumericString(a)||"number"==typeof a)return new Int(a);console.error("ERROR: cannot construct Int object from given type "+typeof a);console.log(a);return new Int("0")}a.updateRepresentation();return new Int(a)}
function Int_round(a,b){if(0==b)return a;a=Int_convertToInt(a);var c=a.get(),c="4"<c[c.length-b]?1:0;return Int_add(Int_rs(a,b),c)};function Int_reciprocol(a,b){a=Int_convertToInt(a);for(var c=new Int(1),e=0,d="",f=0,h=4>2*b?4:2*b;d.length<h&&!c.is0();){for(f=0;Int_lteq(a,c);)c=Int_sub(c,a),++f;if(c.is0())break;else{if(0==d.length&&0!=f||0!=d.length)d+=f.toString();c=Int_ls(c,1);e++}}c.is0()?(d=10==f?d+"1":d+f.toString(),d=new Int(d)):(--e,d=new Int(d),c=0,4<d.data[0]%10&&(c=1),d=Int_add(c,Int_rs(d,1)),--e);return{r:d,p:e}}
function Int_div_fast(a,b,c){a=Int_convertToInt(a);b=Int_convertToInt(b);var e=a.is_negative==b.is_negative?!1:!0;a.is_negative=!1;b.is_negative=!1;if(Int_lt(a,b))return c?a:new Int("z");if(Int_eq(a,b)){if(c)return new Int("z");b=new Int(1);b.is_negative=e;return b}if(1==b.data[0])return c?new Int("z"):new Int(a);if(0==b.data[0])return new Int("z");e=a.repLength();e=Int_reciprocol(b,e);e=Int_rs(Int_mul(a,e.r),e.p);a=Int_sub(a,Int_mul(b,e));return Int_eq(b,a)?c?new Int("z"):Int_add(e,1):c?a:e}
function Int_div_long(a,b,c){for(var e=a.repLength()-b.repLength(),d=new Int("z"),f=0;f<e+1;++f){for(var h=Int_ls(b,e-f),g=0;Int_gteq(a,h);)a=Int_sub(a,h),g++;d=Int_add(d,Int_ls(g,e-f))}return c?a:d}
function Int_div(a,b,c){a=Int_convertToInt(a);b=Int_convertToInt(b);var e=a.is_negative==b.is_negative?!1:!0;a.is_negative=!1;b.is_negative=!1;if(Int_lt(a,b))return c?a:new Int("z");if(Int_eq(a,b)){if(c)return new Int("z");a=new Int(1);a.is_negative=e;return a}if(1==b.data[0])return c?new Int("z"):new Int(a);if(0==b.data[0])return new Int("z");a=Int_div_long(a,b,c);a.is_negative=e;return a};function Int_mul(a,b){a=Int_convertToInt(a);b=Int_convertToInt(b);var c=a.is_negative==b.is_negative?!1:!0;a.is_negative=!1;b.is_negative=!1;if(1==a.data.length&&1==b.data.length){var e=Math.floor(a.data[0]/1E7),d=Math.floor(b.data[0]/1E7),f=a.data[0]%1E7,h=b.data[0]%1E7,g=f*h,k=e*d,m=(e+f)*(d+h)-k-g;return c?Int_add(k.toString()+"00000000000000",Int_add(Int_ls(m,7),g)).negate():Int_add(k.toString()+"00000000000000",Int_add(Int_ls(m,7),g))}if(1==a.data.length){k=Math.floor(b.data.length/2);e=new Int("z");
d=Array(b.data.length-k);f=new Int(b);for(g=b.data.length-1;g>=k;--g)d[g-k]=f.data[g],f.data.pop();e.data=d;return c?Int_add(Int_ls(Int_mul(a,e),a.MAX_DIGITS*k),Int_mul(a,f)).negate():Int_add(Int_ls(Int_mul(a,e),a.MAX_DIGITS*k),Int_mul(a,f))}if(1==b.data.length){k=Math.floor(a.data.length/2);e=new Int("z");d=Array(a.data.length-k);f=new Int(a);for(g=a.data.length-1;g>=k;--g)d[g-k]=f.data[g],f.data.pop();e.data=d;return c?Int_add(Int_ls(Int_mul(e,b),b.MAX_DIGITS*k),Int_mul(f,b)).negate():Int_add(Int_ls(Int_mul(e,
b),b.MAX_DIGITS*k),Int_mul(f,b))}e=Math.floor(a.data.length/2);d=Math.floor(b.data.length/2);f=new Int("z");k=new Int(a);h=Array(a.data.length-e);for(g=a.data.length-1;g>=e;--g)h[g-e]=k.data[g],k.data.pop();f.data=h;for(var h=new Int("z"),l=new Int(b),m=Array(b.data.length-d),g=b.data.length-1;g>=d;--g)m[g-d]=l.data[g],l.data.pop();h.data=m;g=Int_mul(k,l);m=Int_ls(Int_mul(k,h),d*b.MAX_DIGITS);k=Int_ls(Int_mul(f,l),e*a.MAX_DIGITS);e=Int_ls(Int_mul(f,h),(e+d)*a.MAX_DIGITS);return c?Int_add(g,Int_add(m,
Int_add(k,e))).negate():Int_add(g,Int_add(m,Int_add(k,e)))};function Int_ls(a,b){a=Int_convertToInt(a);b=Number(b);for(var c=[],e=0;e<b;++e)c.push("0");return new Int(a.get()+c.join(""))}function Int_substr(a,b,c){b=Int_convertToInt(b);c=Int_convertToInt(c);for(var e=0;Int_lt(e,b);)e++;for(b=0;Int_lt(b,c);)b++;return a.substring(e,b)}function Int_rs(a,b){a=Int_convertToInt(a);b=Number(b);var c=a.is_negative?1:0;return new Int(a.get().substring(0,c+a.repLength()-b))};function Int_sub(a,b){a=Int_convertToInt(a);b=Int_convertToInt(b);if(a.is_negative&&!b.is_negative){a.is_negative=b.is_negative=!1;var c=Int_add(a,b);c.is_negative=!0;return c}if(!a.is_negative&&b.is_negative)return a.is_negative=b.is_negative=!1,Int_add(a,b);var e=a.is_negative;a.is_negative=b.is_negative=!1;if(Int_eq(a,b))return new Int("z");var d;Int_gt(a,b)?(c=a,d=b):(c=b,d=a,e=!e);c=Int_add(c.ninesComplement(),d).ninesComplement();for(c.is_negative=e;0==c.data[c.data.length-1];)c.data.pop();
return c};
