function Int(a){this.MAX_DIGITS=9;this.radix_str="0123456789";this.radix=10;this.data=[];this.updated=this.is_negative=!1;if(a instanceof Int){for(var b=0;b<a.data.length;++b)this.data.push(a.data[b]);this.is_negative=a.is_negative?!0:!1}else{if("number"==typeof a)a=Math.floor(a).toString();else if("string"!=typeof a)return console.error("ERROR: attempted construction of non-numeric object"),this.data.push(0),this.is_negative=!1,this;if("Z"==a||"z"==a)return this.data.push(0),this.updated=!0,this;
if(!Int_isNumericString(a))return console.error("ERROR: cannot construct Int using '"+a+"' which is a non-numeric string"),this.data.push(0),this.is_negative=!1,this;if("-"==a[0]){if(1==a.length)return this.is_negative=!0,this.data.push(0),this;this.is_negative=!0;a=a.substr(1)}if("+"==a[0]){if(1==a.length)return this.is_negative=!1,this.data.push(0),this;this.is_negative=!1;a=a.substr(1)}for(var b=!0,c=0;c<a.length;++c)if("0"!=a[c]){b=!1;break}if(b)return this.data.push(0),this.is_negative=!1,this;
for(var c=a.length-1,e=0,d=0,b=0;b<Math.ceil(a.length/this.MAX_DIGITS);++b){for(d=0;0<=c&&c>=a.length-this.MAX_DIGITS*(b+1);)e+=this.radix_str.indexOf(a[c--])*Math.pow(this.radix,d++);this.data.push(e);e=0}this.updateRepresentation()}}Int.MAX_UNIT=1E9;Int.upper_shift_8="00000000";Int.digits="1350789624";Int.digitsNoZero="756921843";
Int.prototype.get=function(){var a=[];this.removeZeros();1==this.is_negative&&a.push("-");for(var b=this.data.length-1;0<=b;--b){for(var c=this.data[b].toString();1<this.data.length&&b!=this.data.length-1&&c.length<this.MAX_DIGITS;)c="0"+c;a.push(c)}return a.join("")};Int.prototype.toString=function(){return this.get()};Int.prototype.repLength=function(){return this.data.length*this.MAX_DIGITS-(this.MAX_DIGITS-this.data[this.data.length-1].toString().length)};
Int.prototype.negate=function(){this.is_negative=!this.is_negative;return this};Int.prototype.updateRepresentation=function(){if(!this.updated)return this.is0()&&(this.is_negative=!1),this.removeZeros(),this.updated=!0,this};Int.prototype.removeZeros=function(){if(1==this.data.lenth)return this;for(;1<this.data.length&&0==this.data[this.data.length-1];)this.data.pop();return this};Int.prototype.is0=function(){for(var a in this.data)if(0!=this.data[a])return!1;return!0};
Int.prototype.ninesComplement=function(){var a=new Int("z");a.data=[];for(var b=0;b<this.data.length-1;++b)a.data.push(Int.MAX_UNIT-1);for(a.data.push(9);a.data[a.data.length-1]<this.data[this.data.length-1];)a.data[a.data.length-1]=10*a.data[a.data.length-1]+9;for(b in this.data)a.data[b]-=this.data[b];return Int_add(a,1)};
function Int_isNumericString(a){if("string"!=typeof a||0==a.length||-1=="0123456789-+".indexOf(a[0]))return!1;for(var b=1;b<a.length;b++)if(-1=="0123456789".indexOf(a[b]))return!1;return!0}function Int_convertToInt(a){if(!(a instanceof Int)){if("string"==typeof a&&Int_isNumericString(a)||"number"==typeof a)return new Int(a);console.error("ERROR: cannot construct Int object from given type "+typeof a);return new Int("0")}a.updateRepresentation();return new Int(a)}
function Int_eq(a,b){a=Int_convertToInt(a);b=Int_convertToInt(b);if(a.is0()&&b.is0())return!0;if(a.data.length!=b.data.length||a.is_negative!=b.is_negative)return!1;for(var c=0;c<a.data.length;++c)if(a.data[c]!=b.data[c])return!1;return!0}function Int_neq(a,b){return!Int_eq(a,b)}
function Int_lt(a,b){a=Int_convertToInt(a);b=Int_convertToInt(b);if(a.is0()&&b.is0())return!1;if(a.is_negative&&!b.is_negative)return!0;if(!a.is_negative&&b.is_negative)return!1;if(a.data.length<b.data.length)return!0;if(a.data.length>b.data.length)return!1;for(var c=a.data.length-1;0<=c;--c)if(a.data[c]!=b.data[c])return a.data[c]<b.data[c]?a.is_negative?!1:!0:a.is_negative?!0:!1;return!1}function Int_lteq(a,b){return Int_lt(a,b)||Int_eq(a,b)}
function Int_gt(a,b){return!Int_lt(a,b)&&Int_neq(a,b)}function Int_gteq(a,b){return!Int_lt(a,b)}
function Int_add(a,b){a=Int_convertToInt(a);b=Int_convertToInt(b);if(a.is0())return b;if(b.is0())return a;if(a.is_negative&&!b.is_negative)return Int_sub(b,a);if(!a.is_negative&&b.is_negative)return Int_sub(a,b);var c=a.is_negative,e=new Int("z");e.data=[];for(var d=0,f=a.data.length>b.data.length?b.data.length:a.data.length,h=0;h<f;++h)d=a.data[h]+b.data[h]+d,e.data.push(d%Int.MAX_UNIT),d=Math.floor(d/Int.MAX_UNIT);for(;f<a.data.length;)for(d=a.data[f++]+d,e.data.push(d%Int.MAX_UNIT),d=Math.floor(d/
Int.MAX_UNIT);0==d&&f<a.data.length;)e.data.push(a.data[f++]);for(;f<b.data.length;)for(d=b.data[f++]+d,e.data.push(d%Int.MAX_UNIT),d=Math.floor(d/Int.MAX_UNIT);0==d&&f<a.data.length;)e.data.push(a.data[f++]);0<d&&e.data.push(d);e.is_negative=c;return e}function Int_sum(a){for(var b=new Int("z"),c=0;c<a.length;++c)b=Int_add(b,a[c]);return b}
function Int_sub(a,b){a=Int_convertToInt(a);b=Int_convertToInt(b);if(a.is_negative&&!b.is_negative){a.is_negative=b.is_negative=!1;var c=Int_add(a,b);c.is_negative=!0;return c}if(!a.is_negative&&b.is_negative)return a.is_negative=b.is_negative=!1,Int_add(a,b);var e=a.is_negative;a.is_negative=b.is_negative=!1;if(Int_eq(a,b))return new Int("z");var d;Int_gt(a,b)?(c=a,d=b):(c=b,d=a,e=!e);c=Int_add(c.ninesComplement(),d).ninesComplement();for(c.is_negative=e;0==c.data[c.data.length-1];)c.data.pop();
return c}function Int_ls(a,b){a=Int_convertToInt(a);b=Number(b);for(var c=[],e=0;e<b;++e)c.push("0");return new Int(a.get()+c.join(""))}function Int_substr(a,b,c){b=Int_convertToInt(b);c=Int_convertToInt(c);for(var e=0;Int_lt(e,b);)e++;for(b=0;Int_lt(b,c);)b++;return a.substring(e,b)}function Int_rs(a,b){a=Int_convertToInt(a);b=Number(b);var c=a.is_negative?1:0;return new Int(a.get().substring(0,c+a.repLength()-b))}
function Int_mul(a,b){a=Int_convertToInt(a);b=Int_convertToInt(b);var c=a.is_negative==b.is_negative?!1:!0;a.is_negative=!1;b.is_negative=!1;if(1==a.data.length&&1==b.data.length){var e=Math.floor(a.data[0]/1E4),d=Math.floor(b.data[0]/1E4),f=a.data[0]%1E4,h=b.data[0]%1E4,g=f*h,l=e*d,m=(e+f)*(d+h)-l-g;return c?Int_add(l.toString()+Int.upper_shift_8,1E4*m+g).negate():Int_add(l.toString()+Int.upper_shift_8,1E4*m+g)}if(1==a.data.length){l=Math.floor(b.data.length/2);e=new Int("z");d=Array(b.data.length-
l);f=new Int(b);for(g=b.data.length-1;g>=l;--g)d[g-l]=f.data[g],f.data.pop();e.data=d;return c?Int_add(Int_ls(Int_mul(a,e),a.MAX_DIGITS*l),Int_mul(a,f)).negate():Int_add(Int_ls(Int_mul(a,e),a.MAX_DIGITS*l),Int_mul(a,f))}if(1==b.data.length){l=Math.floor(a.data.length/2);e=new Int("z");d=Array(a.data.length-l);f=new Int(a);for(g=a.data.length-1;g>=l;--g)d[g-l]=f.data[g],f.data.pop();e.data=d;return c?Int_add(Int_ls(Int_mul(e,b),b.MAX_DIGITS*l),Int_mul(f,b)).negate():Int_add(Int_ls(Int_mul(e,b),b.MAX_DIGITS*
l),Int_mul(f,b))}e=Math.floor(a.data.length/2);d=Math.floor(b.data.length/2);f=new Int("z");l=new Int(a);h=Array(a.data.length-e);for(g=a.data.length-1;g>=e;--g)h[g-e]=l.data[g],l.data.pop();f.data=h;for(var h=new Int("z"),n=new Int(b),m=Array(b.data.length-d),g=b.data.length-1;g>=d;--g)m[g-d]=n.data[g],n.data.pop();h.data=m;g=Int_mul(l,n);m=Int_ls(Int_mul(l,h),d*b.MAX_DIGITS);l=Int_ls(Int_mul(f,n),e*a.MAX_DIGITS);e=Int_ls(Int_mul(f,h),(e+d)*a.MAX_DIGITS);return c?Int_add(g,Int_add(m,Int_add(l,e))).negate():
Int_add(g,Int_add(m,Int_add(l,e)))}function Int_reciprocol(a,b){a=Int_convertToInt(a);for(var c=new Int(1),e=0,d="",f=0,h=4>2*b?4:2*b;d.length<h&&!c.is0();){for(f=0;Int_lteq(a,c);)c=Int_sub(c,a),++f;if(c.is0())break;else{if(0==d.length&&0!=f||0!=d.length)d+=f.toString();c=Int_ls(c,1);e++}}c.is0()?(d=10==f?d+"1":d+f.toString(),d=new Int(d)):(--e,d=new Int(d),c=0,4<d.data[0]%10&&(c=1),d=Int_add(c,Int_rs(d,1)),--e);return{r:d,p:e}}
function Int_round(a,b){a=Int_convertToInt(a);var c=a.get(),c="8"<c[c.length-b]?1:0;return Int_add(Int_rs(a,b),c)}function Int_div_fast(a,b,c){var e=a.repLength(),e=Int_reciprocol(b,e),e=Int_rs(Int_mul(a,e.r),e.p);a=Int_sub(a,Int_mul(b,e));return Int_eq(b,a)?c?new Int("z"):Int_add(e,1):c?a:e}function Int_div_long(a,b,c){for(var e=a.repLength()-b.repLength(),d=new Int("z"),f=0;f<e+1;++f){for(var h=Int_ls(b,e-f),g=0;Int_gteq(a,h);)a=Int_sub(a,h),g++;d=Int_add(d,Int_ls(g,e-f))}return c?a:d}
function Int_div(a,b,c){a=Int_convertToInt(a);b=Int_convertToInt(b);var e=a.is_negative==b.is_negative?!1:!0;a.is_negative=!1;b.is_negative=!1;if(Int_lt(a,b))return c?a:new Int("z");if(Int_eq(a,b)){if(c)return new Int("z");a=new Int(1);a.is_negative=e;return a}if(1==b.data[0])return c?new Int("z"):new Int(a);if(0==b.data[0])return new Int("z");a=(a.repLength()>3*b.repLength()?Int_div_fast:Int_div_long)(a,b,c);a.is_negative=e;return a}
function Int_mod(a,b){a=Int_convertToInt(a);b=Int_convertToInt(b);var c=Int_div(a,b,!0);console.log(a.is_negative);a.is_negative&&(c=Int_sub(b,c));return c}function Int_pow(a,b){Int_convertToInt(a);Int_convertToInt(b)}
function performanceTest(){console.log("initializing performanceTest...");for(var a=[],b=[],c=[],e=[],d=[],f=[],h=[],g=[],l=[],m=[],n=0;10>n;++n)a.push(Math.floor(10*Math.random())),b.push(Math.floor(10*Math.random())),c.push(Math.floor(10*Math.random())),e.push(Math.floor(10*Math.random())),d.push(Math.floor(10*Math.random())),f.push(Math.floor(10*Math.random())),h.push(Math.floor(10*Math.random())),g.push(Math.floor(10*Math.random())),l.push(Math.floor(10*Math.random())),m.push(Math.floor(10*Math.random()));
for(n=0;40>n;++n)c.push(Math.floor(10*Math.random())),e.push(Math.floor(10*Math.random())),d.push(Math.floor(10*Math.random())),f.push(Math.floor(10*Math.random())),h.push(Math.floor(10*Math.random())),g.push(Math.floor(10*Math.random())),l.push(Math.floor(10*Math.random())),m.push(Math.floor(10*Math.random()));for(n=0;50>n;++n)d.push(Math.floor(10*Math.random())),f.push(Math.floor(10*Math.random())),h.push(Math.floor(10*Math.random())),g.push(Math.floor(10*Math.random())),l.push(Math.floor(10*Math.random())),
m.push(Math.floor(10*Math.random()));for(n=0;900>n;++n)h.push(Math.floor(10*Math.random())),g.push(Math.floor(10*Math.random())),l.push(Math.floor(10*Math.random())),m.push(Math.floor(10*Math.random()));for(n=0;9E3>n;++n)l.push(Math.floor(10*Math.random())),m.push(Math.floor(10*Math.random()));a=a.join("");b=b.join("");c=c.join("");e=e.join("");d=d.join("");f=f.join("");h=h.join("");g=g.join("");l=l.join("");m=m.join("");console.log("completed init");console.log("using following inputs:");console.log(a,
b,c,e,d,f,h,g,l,m);console.log("starting performance tests...");n=new Date;console.log("running add tests...");var k=new Date;Int_add(a,b);console.log("\t10 digit add:\t\t\t",new Date-k);k=new Date;Int_add(c,e);console.log("\t50 digit add:\t\t\t",new Date-k);k=new Date;Int_add(d,f);console.log("\t100 digit add:\t\t\t",new Date-k);k=new Date;Int_add(h,g);console.log("\t1000 digit add:\t\t\t",new Date-k);k=new Date;Int_add(l,m);console.log("\t10000 digit add:\t\t",new Date-k);k=new Date;Int_add(l,b);
console.log("\t10000 digit add:\t\t",new Date-k);console.log("running sub tests...");k=new Date;Int_sub(a,b);console.log("\t10 digit sub:\t\t\t",new Date-k);k=new Date;Int_sub(c,e);console.log("\t50 digit sub:\t\t\t",new Date-k);k=new Date;Int_sub(d,f);console.log("\t100 digit sub:\t\t\t",new Date-k);k=new Date;Int_sub(h,g);console.log("\t1000 digit sub:\t\t\t",new Date-k);k=new Date;Int_sub(l,m);console.log("\t10000 digit sub:\t\t",new Date-k);console.log("running mul tests...");k=new Date;Int_mul(a,
b);console.log("\t10 digit mul:\t\t\t",new Date-k);k=new Date;Int_mul(c,e);console.log("\t50 digit mul:\t\t\t",new Date-k);k=new Date;Int_mul(d,f);console.log("\t100 digit mul:\t\t\t",new Date-k);k=new Date;Int_mul(h,f);console.log("\t1000 digit mul:\t\t\t",new Date-k);console.log("running div tests...");k=new Date;Int_div(a,b);console.log("\t10 digit div:\t\t\t",new Date-k);k=new Date;Int_div(c,b);console.log("\t50 digit div:\t\t\t",new Date-k);k=new Date;Int_div(d,b);console.log("\t100 digit div:\t\t\t",
new Date-k);k=new Date;Int_div(h,b);console.log("\t1000 digit div:\t\t\t",new Date-k);console.log("running eq tests...");k=new Date;Int_eq(a,a);console.log("\t10 digit eq:\t\t\t",new Date-k);k=new Date;Int_eq(c,c);console.log("\t50 digit eq:\t\t\t",new Date-k);k=new Date;Int_eq(d,d);console.log("\t100 digit eq:\t\t\t",new Date-k);k=new Date;Int_eq(h,h);console.log("\t1000 digit eq:\t\t\t",new Date-k);k=new Date;Int_eq(l,l);console.log("\t10000 digit eq:\t\t\t",new Date-k);console.log("running lt tests...");
k=new Date;Int_lt(a,b);console.log("\t10 digit lt:\t\t\t",new Date-k);a=new Date;Int_lt(c,e);console.log("\t50 digit lt:\t\t\t",new Date-a);a=new Date;Int_lt(d,f);console.log("\t100 digit lt:\t\t\t",new Date-a);a=new Date;Int_lt(h,g);console.log("\t1000 digit lt:\t\t\t",new Date-a);a=new Date;Int_lt(l,m);console.log("\t10000 digit lt:\t\t\t",new Date-a);console.log("overall performance:",new Date-n);console.log("finished")}
function randstr(a){for(var b="",c=0;c<a;c++)b+=Int.digits[Math.floor(10*Math.random())];for(a=0;"0"==b[a];)++a;for(b=b.substring(a);0<a--;)b+=Int.digitsNoZero[Math.floor(9*Math.random())];return b}
function runCorrectnessTest(a){var b=[],c=[];switch(a){case "+":a=Int_add;break;case "-":a=Int_sub;break;case "x":a=Int_mul;break;case "/":a=Int_div;break;default:a=Int_eq}for(var e=0;100>e;++e){for(var d=[],f=[],h=0;50>h;h++)d.push(randstr(e+1)),f.push(randstr(e+1));b.push(d);c.push(f)}document.createElement("DIV");e=new Date;for(d=0;100>d;++d)for(console.log(d),f=0;50>f;++f){var g=new Int(b[d][f]),h=new Int(c[d][f]),l=a(g,h);document.getElementById("body").appendChild(document.createTextNode(g.get()+
" "+h.get()+" "+l.get()));document.getElementById("body").appendChild(document.createElement("br"));var l=new Int(c[99-d][f]),m=a(g,l);document.getElementById("body").appendChild(document.createTextNode(g.get()+" "+l.get()+" "+m.get()));document.getElementById("body").appendChild(document.createElement("br"));g=new Int(b[99-d][f]);l=a(g,h);document.getElementById("body").appendChild(document.createTextNode(g.get()+" "+h.get()+" "+l.get()));document.getElementById("body").appendChild(document.createElement("br"))}for(b=
100;2<=b;--b)for(c=b-1;1<=c;--c)console.log(b,c),d=new Int(b),f=new Int(c),h=a(d,f),document.getElementById("body").appendChild(document.createTextNode(d.get()+" "+f.get()+" "+h.get())),document.getElementById("body").appendChild(document.createElement("br"));console.log("25000 binary ops executed in: ",(new Date-e)/1E3,"seconds")}
function divCrossoverTest(){for(var a=[],b=[],c=[],e=[],d=0;40>d;++d){for(var f=[],h=[],g=0;15>g;g++)f.push(randstr(d+1)),h.push(randstr(d+1));a.push(f);b.push(h);c.push({sum:0,cnt:0,avg:0});e.push({sum:0,cnt:0,avg:0})}console.log("running long division tests...");for(d=0;40>d;++d)for(console.log(d),f=d;40>f;++f)for(h=0;15>h;++h)g=new Date,Int_div_long(a[f][h],b[d][h]),c[f-d].sum+=new Date-g,c[f-d].cnt+=1;console.log("running fast division tests...");for(d=0;40>d;++d)for(console.log(d),f=d;40>f;++f)for(h=
0;15>h;++h)g=new Date,Int_div_fast(a[f][h],b[d][h]),e[f-d].sum+=new Date-g,e[f-d].cnt+=1;for(g=0;40>g;++g)c[g].avg=c[g].sum/c[g].cnt,e[g].avg=e[g].sum/e[g].cnt;console.log("DIG-DIFF | LONG | FAST");for(a=0;40>a;++a)console.log(a,"|",c[a].avg,"|",e[a].avg)};
